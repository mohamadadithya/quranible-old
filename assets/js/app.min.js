const mainNav=document.querySelector(".main-nav"),sidebar=document.querySelector(".sidebar"),surahsContainer=document.querySelector(".surahs .container"),dailyPrayerContainer=document.querySelector(".daily-prayer-page .container"),timeListContainer=document.querySelector(".time-list"),versesContainer=document.querySelector(".verses"),asmaulHusnaContainer=document.querySelector(".asmaul-husna-page .container"),prayerIntentionsContainer=document.querySelector(".prayer-intentions-page .container"),audioEl=document.querySelector(".audio"),themeToggle=document.querySelector(".check-toggle"),footer=document.querySelector("footer"),offlineSection=document.querySelector(".offline"),sidebarLinks=sidebar.querySelectorAll(".link"),loader=document.querySelector(".loader"),pages=document.querySelectorAll(".page"),surahPage=pages[0];"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/serviceWorker.js").then(()=>console.log("Service worker registered")).catch(a=>console.log("Service worker not registered",a))}),sidebarLinks.forEach((a,b)=>{a.addEventListener("click",()=>{sidebar.classList.remove("active")}),1===b?a.addEventListener("click",async()=>{pages[b+1].classList.add("active"),showLoader();const a=await fetch("https://api.npoint.io/31b52b3caae1b5c00c17"),c=await a.json(),d=await c;showDailyPrayer(d),hideLoader()}):2===b?a.addEventListener("click",async()=>{pages[b-1].classList.add("active"),showLoader();const a=await fetch("https://api.techniknews.net/ipgeo/"),c=await a.json(),d=await c;getLocation(d.city)}):3===b?a.addEventListener("click",async()=>{pages[b].classList.add("active"),showLoader();const a=await fetch("https://api.npoint.io/7c853c9f8335e6e948dd"),c=await a.json(),d=await c;showAsmaulHusna(d),hideLoader()}):4==b&&a.addEventListener("click",async()=>{pages[b].classList.add("active"),showLoader();const a=await fetch("https://api.npoint.io/ab0d08dc6a3ca914b0fe"),c=await a.json(),d=await c;showPrayerIntentions(d),hideLoader()})});const showAsmaulHusna=a=>{document.body.style.overflowY="hidden",mainNav.innerHTML=`
  <li onclick="closePage()"><a href="#" class="far fa-chevron-left text-white"></a></li>
  <li class="logo">Asmaul Husna</li>`,a.forEach(a=>{asmaulHusnaContainer.innerHTML+=`<div class="primary-card shadow">
    <h2 class="name">${a.urutan}. ${a.latin}</h2>
    <p class="arab">${a.arab}</p>
    <p class="text-gray">${a.arti}</p>
  </div>`})},showPrayerIntentions=a=>{document.body.style.overflowY="hidden",mainNav.innerHTML=`
  <li onclick="closePage()"><a href="#" class="far fa-chevron-left text-white"></a></li>
  <li class="logo">Niat-Niat Sholat</li>
  `,a.forEach(a=>{prayerIntentionsContainer.innerHTML+=`<div class="primary-card shadow">
    <h2 class="name">${a.name}</h2>
    <p class="arab">${a.arab}</p>
    <p class="latin">${a.latin}</p>
    <p class="means">${a.means}</p>
 </div>`})},getLocation=async a=>{const b=await fetch(`https://api.banghasan.com/sholat/format/json/kota/nama/${a}`),c=await b.json(),d=await c,e=d.kota[0].id;getAdzan(e,a)},getAdzan=async(a,b)=>{showLoader();const c=new Date().toLocaleDateString("en-CA"),d=await fetch(`https://api.banghasan.com/sholat/format/json/jadwal/kota/${a}/tanggal/${c}`),e=await d.json(),f=await e;showAdzan(f.jadwal.data,b),hideLoader()},showAdzan=(a,b)=>{const c={location:document.querySelector(".adzan-page .location"),name:document.querySelector(".adzan-page .name"),time:document.querySelector(".adzan-page .time"),timeIcon:document.querySelector(".adzan-page .time-icon"),date:document.querySelector(".adzan-page .date")};document.body.style.overflowY="hidden",mainNav.innerHTML=`
  <li onclick="closePage()"><a href="#" class="far fa-chevron-left text-white"></a></li>
  <li class="logo">Waktu Sholat</li>
  `,c.location.innerHTML=`<i class="far fa-map-marker-alt"></i> ${b}`;const d={shubuh:{name:"Shubuh",time:a.subuh,icon:"fa-sunrise"},dhuhr:{name:"Dzuhur",time:a.dzuhur,icon:"fa-sun"},ashar:{name:"Ashar",time:a.ashar,icon:"fa-sun"},maghrib:{name:"Maghrib",time:a.maghrib,icon:"fa-sunset"},isya:{name:"Isya",time:a.isya,icon:"fa-moon"}},e=d.shubuh.time,f=d.dhuhr.time,g=d.ashar.time,h=d.maghrib.time,i=d.isya.time,j=new Date,k=`${j.toLocaleString("it-IT",{hour:"2-digit",minute:"2-digit"})}`;k>=e&&k<=f&&(c.name.innerText=d.dhuhr.name,c.timeIcon.classList.replace("fa-none",d.dhuhr.icon),c.time.innerText=f),k>=f&&k<=g&&(c.name.innerText=d.ashar.name,c.timeIcon.classList.replace("fa-none",d.ashar.icon),c.time.innerText=g),k>=g&&k<=h&&(c.name.innerText=d.maghrib.name,c.timeIcon.classList.replace("fa-none",d.maghrib.icon),c.time.innerText=h),k>=h&&k<=i&&(c.name.innerText=d.isya.name,c.timeIcon.classList.replace("fa-none",d.isya.icon),c.time.innerText=i),(k>=i||k<=e)&&(c.name.innerText=d.shubuh.name,c.timeIcon.classList.add("fa-none",d.shubuh.icon),c.time.innerText=e),c.date.innerText=j.toLocaleString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"});const l=document.querySelector(".time-list"),m=Object.values(d);m.forEach(a=>{l.innerHTML+=`<div class="card flex align-center between shadow">
    <span class="flex align-center">
       <i class="far fa-fw ${a.icon}"></i>
       <p class="name">${a.name}</p>
    </span>
    <p class="time">${a.time}</p>
 </div>`})},showDailyPrayer=a=>{document.body.style.overflowY="hidden",mainNav.innerHTML=`
  <li onclick="closePage()"><a href="#" class="far fa-chevron-left text-white"></a></li>
  <li class="logo">Doa-Doa Harian</li>
  `,a.forEach(a=>{dailyPrayerContainer.innerHTML+=`<div class="primary-card shadow">
    <h2 class="name">${a.doa}</h2>
    <p class="arab">${a.ayat}</p>
    <p class="latin">${a.latin}</p>
    <p class="means">${a.artinya}</p>
 </div>`})};window.addEventListener("offline",()=>{offlineSection.style.display=navigator.onLine?"none":"grid"}),window.addEventListener("hashchange",a=>{a.oldURL.length>a.newURL.length&&closePage()});let darkTheme=!1;const currentTheme=localStorage.getItem("theme")?localStorage.getItem("theme"):null;if(currentTheme&&(document.documentElement.setAttribute("data-theme",currentTheme),"dark"===currentTheme)){const a=themeToggle.previousElementSibling;themeToggle.checked=!0,a.classList.replace("fa-moon","fa-sun"),darkTheme=!0}const getSurahs=async()=>{const a=await fetch(`https://api.quran.gading.dev/surah`);showLoader();const b=await a.json(),c=await b.data;showSurahs(c),hideLoader()};getSurahs();const showSurahs=a=>{for(let b in a)surahsContainer.innerHTML+=`<a href="#${a[b].name.transliteration.id.toLowerCase()}" class="surah flex shadow" onclick="showSurah(${a[b].number})">
             <p class="number">${a[b].number}</p>
             <div>
              <h3 class="name">${a[b].name.transliteration.id}</h3>
               <p class="desc text-gray">${a[b].name.translation.id} â€¢ ${a[b].numberOfVerses} ayat</p>
             </div>
           </a>`},showSurah=a=>{sidebar.classList.remove("active"),showLoader(),fetch(`https://api.quran.gading.dev/surah/${a}`).then(a=>a.json()).then(a=>{getSurah(a.data),hideLoader()}),surahPage.classList.add("active")},getSurah=a=>{document.body.style.overflowY="hidden",mainNav.innerHTML=`
         <li onclick="closePage()"><a href="#" class="far fa-chevron-left text-white"></a></li>
         <li class="logo">${a.name.transliteration.id}</li>
         <li class="far fa-play toggle" onclick="toggleAudios(this)" data-number="${a.number}"></li>
         `;let b;for(b=1===a.number?1:0,b;b<a.verses.length;b++)versesContainer.innerHTML+=`<ul class="verse">
         <li class="arab">${a.verses[b].text.arab}</li>
         <li class="latin">${a.verses[b].number.inSurah}. ${a.verses[b].text.transliteration.en}</li>
         <li class="means text-gray">${a.verses[b].translation.id}</li>
         <li class="far fa-play toggle" onclick="toggleAudio(this)" data-audio="${a.verses[b].audio.primary}"></li>
       </ul>`},toggleAudio=a=>{changeAudioToggles();let b=a.getAttribute("data-audio");a.classList.toggle("play"),audioEl.src=b,a.classList.contains("play")?(a.classList.replace("fa-play","fa-stop"),audioEl.play()):(a.classList.replace("fa-stop","fa-play"),audioEl.pause()),audioEl.onended=()=>{a.classList.replace("fa-stop","fa-play")}},toggleAudios=a=>{changeAudioToggles();let b=a.getAttribute("data-number");a.classList.toggle("play"),fetch(`https://api.quran.sutanlab.id/surah/${b}`).then(a=>a.json()).then(b=>{playAudios(b.data.verses,a)})},playAudios=(a,b)=>{let c=1;audioEl.src=a[0].audio.primary,b.classList.contains("play")?(audioEl.play(),b.classList.replace("fa-play","fa-stop")):(audioEl.pause(),b.classList.replace("fa-stop","fa-play")),audioEl.onended=()=>{b.classList.replace("fa-stop","fa-play"),audioEl.src=a[c++].audio.primary,audioEl.play(),b.classList.replace("fa-play","fa-stop")}},closePage=()=>{document.body.style.overflowY="auto";const a=document.querySelectorAll(".page");a.forEach(a=>{a.classList.remove("active")}),mainNav.innerHTML=`<li class="menu toggle" onclick="showSidebar()"><i class="far fa-bars"></i></li>
  <li class="logo">Quranible</li>
  <li class="theme-toggle">
  <label for="check-toggle" class="far ${!0===darkTheme?"fa-sun":"fa-moon"} toggle"></label>
  <input type="checkbox" class="check-toggle" id="check-toggle" onchange="setTheme(this)">
  </li>`,setTimeout(()=>{versesContainer.innerHTML="",dailyPrayerContainer.innerHTML="",timeListContainer.innerHTML="",asmaulHusnaContainer.innerHTML="",prayerIntentionsContainer.innerHTML=""},500)},changeAudioToggles=()=>{const a=document.querySelectorAll(".toggle");a.forEach(a=>{a.classList.replace("fa-stop","fa-play")})},setTheme=a=>{const b=a.previousElementSibling;a.checked?(b.classList.replace("fa-moon","fa-sun"),darkTheme=!0,document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(b.classList.replace("fa-sun","fa-moon"),darkTheme=!1,document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))},showSidebar=()=>{sidebar.classList.toggle("active")},showLoader=()=>{loader.classList.add("active")},hideLoader=()=>{loader.classList.remove("active")};